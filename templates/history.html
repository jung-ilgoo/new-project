<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²½ê¸° ê¸°ë¡ ì¡°íšŒ</title>
  <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    .action-buttons {
      white-space: nowrap;
    }
    .password-incorrect {
      color: #dc3545;
      font-size: 0.875rem;
      margin-top: 0.25rem;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container my-4">
    <h1 class="text-center mb-4">ğŸ“œ ê²½ê¸° ê¸°ë¡ ì¡°íšŒ</h1>
    
    <!-- ì‚­ì œ í™•ì¸ ëª¨ë‹¬ -->
    <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deleteConfirmModalLabel">ê²½ê¸° ê¸°ë¡ ì‚­ì œ</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>ì •ë§ë¡œ ì´ ê²½ê¸° ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            
            <div class="form-group mb-3">
              <label for="deletePassword" class="form-label">ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:</label>
              <input type="password" class="form-control" id="deletePassword" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
              <div id="passwordIncorrect" class="password-incorrect">
                ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn">ì‚­ì œ</button>
            <form id="deleteForm" method="POST" action="" style="display: none;">
              <button type="submit" id="submitDeleteForm"></button>
            </form>
          </div>
        </div>
      </div>
    </div>
    
    <!-- ìš”ì•½ ì •ë³´ í…Œì´ë¸” -->
    <div class="table-responsive">
      <table class="table table-striped">
        <thead class="table-dark">
          <tr>
            <th>ë‚ ì§œ</th>
            <th>ë¸”ë£¨íŒ€ ìš”ì•½</th>
            <th>ë ˆë“œíŒ€ ìš”ì•½</th>
            <th>ìŠ¹ë¦¬ íŒ€</th>
            <th>ê´€ë¦¬</th>
          </tr>
        </thead>
        <tbody>
          {% for match in matches %}
          <tr>
            <!-- match_date: index 1 -->
            <td>{{ match[1] }}</td>
            <!-- ë¸”ë£¨íŒ€ ìš”ì•½: ê° í¬ì§€ì…˜ì˜ í”Œë ˆì´ì–´ ì´ë¦„ -->
            <td>
              TOP: {{ match[2] }}, 
              JUNGLE: {{ match[7] }}, 
              MID: {{ match[12] }}, 
              ADC: {{ match[17] }}, 
              SUP: {{ match[22] }}
            </td>
            <!-- ë ˆë“œíŒ€ ìš”ì•½ -->
            <td>
              TOP: {{ match[27] }}, 
              JUNGLE: {{ match[32] }}, 
              MID: {{ match[37] }}, 
              ADC: {{ match[42] }}, 
              SUP: {{ match[47] }}
            </td>
            <!-- winner: index 52 -->
            <td>{{ match[52] }}</td>
            <td class="action-buttons">
              <!-- ê´€ë¦¬ ë²„íŠ¼ ê·¸ë£¹ -->
              <div class="btn-group btn-group-sm">
                <!-- ìƒì„¸ë³´ê¸° ë²„íŠ¼ -->
                <button class="btn btn-info" type="button" data-bs-toggle="collapse" data-bs-target="#details{{ loop.index }}" aria-expanded="false" aria-controls="details{{ loop.index }}">
                  ìƒì„¸ë³´ê¸°
                </button>
                
                <!-- ìˆ˜ì • ë²„íŠ¼ -->
                <a href="/edit_match/{{ match[0] }}" class="btn btn-primary">
                  ìˆ˜ì •
                </a>
                
                <!-- ì‚­ì œ ë²„íŠ¼ (ëª¨ë‹¬ íŠ¸ë¦¬ê±°) -->
                <button class="btn btn-danger" type="button" onclick="prepareDelete('{{ match[0] }}')">
                  ì‚­ì œ
                </button>
              </div>
            </td>
          </tr>
          <!-- ìƒì„¸ ì •ë³´ í–‰: collapseë¥¼ ì´ìš©í•˜ì—¬ í† ê¸€ -->
          <tr class="collapse" id="details{{ loop.index }}">
            <td colspan="5">
              <div class="row">
                <!-- ë¸”ë£¨íŒ€ ìƒì„¸ ì •ë³´ -->
                <div class="col-md-6">
                  <h5>ğŸ”¹ ë¸”ë£¨íŒ€ ìƒì„¸ ì •ë³´</h5>
                  <ul class="list-group">
                    <li class="list-group-item">
                      <strong>TOP:</strong> {{ match[2] }} 
                      (ì±”í”¼ì–¸: {{ match[3] }}, K/D/A: {{ match[4] }}/{{ match[5] }}/{{ match[6] }})
                    </li>
                    <li class="list-group-item">
                      <strong>JUNGLE:</strong> {{ match[7] }} 
                      (ì±”í”¼ì–¸: {{ match[8] }}, K/D/A: {{ match[9] }}/{{ match[10] }}/{{ match[11] }})
                    </li>
                    <li class="list-group-item">
                      <strong>MID:</strong> {{ match[12] }} 
                      (ì±”í”¼ì–¸: {{ match[13] }}, K/D/A: {{ match[14] }}/{{ match[15] }}/{{ match[16] }})
                    </li>
                    <li class="list-group-item">
                      <strong>ADC:</strong> {{ match[17] }} 
                      (ì±”í”¼ì–¸: {{ match[18] }}, K/D/A: {{ match[19] }}/{{ match[20] }}/{{ match[21] }})
                    </li>
                    <li class="list-group-item">
                      <strong>SUPPORT:</strong> {{ match[22] }} 
                      (ì±”í”¼ì–¸: {{ match[23] }}, K/D/A: {{ match[24] }}/{{ match[25] }}/{{ match[26] }})
                    </li>
                  </ul>
                </div>
                <!-- ë ˆë“œíŒ€ ìƒì„¸ ì •ë³´ -->
                <div class="col-md-6">
                  <h5>ğŸ”º ë ˆë“œíŒ€ ìƒì„¸ ì •ë³´</h5>
                  <ul class="list-group">
                    <li class="list-group-item">
                      <strong>TOP:</strong> {{ match[27] }} 
                      (ì±”í”¼ì–¸: {{ match[28] }}, K/D/A: {{ match[29] }}/{{ match[30] }}/{{ match[31] }})
                    </li>
                    <li class="list-group-item">
                      <strong>JUNGLE:</strong> {{ match[32] }} 
                      (ì±”í”¼ì–¸: {{ match[33] }}, K/D/A: {{ match[34] }}/{{ match[35] }}/{{ match[36] }})
                    </li>
                    <li class="list-group-item">
                      <strong>MID:</strong> {{ match[37] }} 
                      (ì±”í”¼ì–¸: {{ match[38] }}, K/D/A: {{ match[39] }}/{{ match[40] }}/{{ match[41] }})
                    </li>
                    <li class="list-group-item">
                      <strong>ADC:</strong> {{ match[42] }} 
                      (ì±”í”¼ì–¸: {{ match[43] }}, K/D/A: {{ match[44] }}/{{ match[45] }}/{{ match[46] }})
                    </li>
                    <li class="list-group-item">
                      <strong>SUPPORT:</strong> {{ match[47] }} 
                      (ì±”í”¼ì–¸: {{ match[48] }}, K/D/A: {{ match[49] }}/{{ match[50] }}/{{ match[51] }})
                    </li>
                  </ul>
                </div>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ (ê°œì„ ëœ ë²„ì „) -->
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <!-- ì´ì „ í˜ì´ì§€ ë²„íŠ¼ -->
        {% if current_page > 1 %}
        <li class="page-item">
          <a class="page-link" href="/history?page={{ current_page - 1 }}" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <span class="page-link">&laquo;</span>
        </li>
        {% endif %}

        <!-- í˜ì´ì§€ ë²ˆí˜¸ -->
        {% for page_num in page_numbers %}
          {% if page_num is string %}
            <!-- ìƒëµ í‘œì‹œ (ë¬¸ìì—´ì¸ ê²½ìš°ëŠ” '...'ë§Œ í•´ë‹¹) -->
            <li class="page-item disabled">
              <span class="page-link">{{ page_num }}</span>
            </li>
          {% else %}
            <!-- í˜ì´ì§€ ë²ˆí˜¸ -->
            <li class="page-item {% if page_num == current_page %}active{% endif %}">
              <a class="page-link" href="/history?page={{ page_num }}">{{ page_num }}</a>
            </li>
          {% endif %}
        {% endfor %}

        <!-- ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼ -->
        {% if current_page < total_pages %}
        <li class="page-item">
          <a class="page-link" href="/history?page={{ current_page + 1 }}" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <span class="page-link">&raquo;</span>
        </li>
        {% endif %}
      </ul>
    </nav>

    <!-- í˜ì´ì§€ ì •ë³´ í‘œì‹œ -->
    <div class="text-center text-muted mb-3">
      <small>ì´ {{ total_pages }}í˜ì´ì§€ ì¤‘ {{ current_page }}í˜ì´ì§€</small>
    </div>

    <div class="text-center mt-3">
      <a href="/" class="btn btn-secondary">ğŸ  í™ˆìœ¼ë¡œ</a>
    </div>
  </div>

  <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- ì‚­ì œ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    // ì‚­ì œ ë¹„ë°€ë²ˆí˜¸ ìƒìˆ˜
    const DELETE_PASSWORD = "8888";
    
    // ì‚­ì œ ëª¨ë‹¬ ì¤€ë¹„ í•¨ìˆ˜
    function prepareDelete(matchId) {
      // ì‚­ì œ í¼ì˜ action ì†ì„± ì—…ë°ì´íŠ¸
      document.getElementById('deleteForm').action = '/delete_match/' + matchId;
      
      // ì´ì „ ì…ë ¥ ë‚´ìš©ê³¼ ì˜¤ë¥˜ ë©”ì‹œì§€ ì´ˆê¸°í™”
      document.getElementById('deletePassword').value = '';
      document.getElementById('passwordIncorrect').style.display = 'none';
      
      // ëª¨ë‹¬ í‘œì‹œ
      var deleteModal = document.getElementById('deleteConfirmModal');
      var modal = new bootstrap.Modal(deleteModal);
      modal.show();
    }
    
    // DOMì´ ë¡œë“œëœ í›„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    document.addEventListener('DOMContentLoaded', function() {
      // ì‚­ì œ í™•ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
        const inputPassword = document.getElementById('deletePassword').value;
        
        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
        if (inputPassword === DELETE_PASSWORD) {
          // ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜í•˜ë©´ ì‚­ì œ í¼ ì œì¶œ
          document.getElementById('submitDeleteForm').click();
        } else {
          // ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜ ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
          document.getElementById('passwordIncorrect').style.display = 'block';
        }
      });
      
      // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œì—ì„œ ì—”í„° í‚¤ ì´ë²¤íŠ¸
      document.getElementById('deletePassword').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          document.getElementById('confirmDeleteBtn').click();
        }
      });
    });
  </script>
</body>
</html>